{"version":3,"sources":["jquery.smoothwheel.js"],"names":["$","self","container","running","currentY","targetY","oldY","maxScrollTop","minScrollTop","direction","onRenderCallback","fricton","vy","stepAmt","minMovement","ts","updateScrollTarget","amt","render","scrollTop","animateLoop","requestAnimFrame","onWheel","e","preventDefault","evt","originalEvent","delta","detail","wheelDelta","dir","window","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","callback","setTimeout","normalizeWheelDelta","distribution","done","scale","n","abs","Math","outer","i","length","splice","push","factor","floor","fn","smoothWheel","options","jQuery","extend","arguments","each","index","elm","bind","get","clientHeight","scrollHeight","onRender","remove","log","unbind"],"mappings":"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","sourcesContent":["/**\n * Created by IntelliJ IDEA.\n *\n * User: phil\n * Date: 15/11/12\n * Time: 11:04 AM\n *\n */\n(function ($) {\n\n    var self = this, container, running=false, currentY = 0, targetY = 0, oldY = 0, maxScrollTop= 0, minScrollTop, direction, onRenderCallback=null,\n            fricton = 0.95, // higher value for slower deceleration\n            vy = 0,\n            stepAmt = 1,\n            minMovement= 0.1,\n            ts=0.1;\n\n    var updateScrollTarget = function (amt) {\n        targetY += amt;\n        vy += (targetY - oldY) * stepAmt;\n      \n        oldY = targetY;\n\n\n    }\n    var render = function () {\n        if (vy < -(minMovement) || vy > minMovement) {\n\n            currentY = (currentY + vy);\n            if (currentY > maxScrollTop) {\n                currentY = vy = 0;\n            } else if (currentY < minScrollTop) {\n                    vy = 0;\n                    currentY = minScrollTop;\n                }\n           \n            container.scrollTop(-currentY);\n\n            vy *= fricton;\n            \n         //   vy += ts * (currentY-targetY);\n            // scrollTopTweened += settings.tweenSpeed * (scrollTop - scrollTopTweened);\n            // currentY += ts * (targetY - currentY);\n\n            if(onRenderCallback){\n                onRenderCallback();\n            }\n        }\n    }\n    var animateLoop = function () {\n        if(! running)return;\n        requestAnimFrame(animateLoop);\n        render();\n        //log(\"45\",\"animateLoop\",\"animateLoop\", \"\",stop);\n    }\n    var onWheel = function (e) {\n        e.preventDefault();\n        var evt = e.originalEvent;\n       \n        var delta = evt.detail ? evt.detail * -1 : evt.wheelDelta / 40;\n        var dir = delta < 0 ? -1 : 1;\n        if (dir != direction) {\n            vy = 0;\n            direction = dir;\n        }\n\n        //reset currentY in case non-wheel scroll has occurred (scrollbar drag, etc.)\n        currentY = -container.scrollTop();\n        \n        updateScrollTarget(delta);\n    }\n\n    /*\n     * http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n     */\n    window.requestAnimFrame = (function () {\n        return  window.requestAnimationFrame ||\n                window.webkitRequestAnimationFrame ||\n                window.mozRequestAnimationFrame ||\n                window.oRequestAnimationFrame ||\n                window.msRequestAnimationFrame ||\n                function (callback) {\n                    window.setTimeout(callback, 1000 / 60);\n                }; \n              \n                \n    })();\n\n    /*\n     * http://jsbin.com/iqafek/2/edit\n     */\n    var normalizeWheelDelta = function () {\n        // Keep a distribution of observed values, and scale by the\n        // 33rd percentile.\n        var distribution = [], done = null, scale = 30;\n        return function (n) {\n            // Zeroes don't count.\n            if (n == 0) return n;\n            // After 500 samples, we stop sampling and keep current factor.\n            if (done != null) return n * done;\n            var abs = Math.abs(n);\n            // Insert value (sorted in ascending order).\n            outer: do { // Just used for break goto\n                for (var i = 0; i < distribution.length; ++i) {\n                    if (abs <= distribution[i]) {\n                        distribution.splice(i, 0, abs);\n                        break outer;\n                    }\n                }\n                distribution.push(abs);\n            } while (false);\n            // Factor is scale divided by 33rd percentile.\n            var factor = scale / distribution[Math.floor(distribution.length / 3)];\n            if (distribution.length == 500) done = factor;\n            return n * factor;\n        };\n    }();\n\n\n    $.fn.smoothWheel = function () {\n        //  var args = [].splice.call(arguments, 0);\n        var options = jQuery.extend({}, arguments[0]);\n        return this.each(function (index, elm) {\n\n            if(!('ontouchstart' in window)){\n                container = $(this);\n                container.bind(\"mousewheel\", onWheel);\n                container.bind(\"DOMMouseScroll\", onWheel);\n\n                //set target/old/current Y to match current scroll position to prevent jump to top of container\n                targetY = oldY = container.get(0).scrollTop;\n                currentY = -targetY;\n                \n                minScrollTop = container.get(0).clientHeight - container.get(0).scrollHeight;\n                if(options.onRender){\n                    onRenderCallback = options.onRender;\n                }\n                if(options.remove){\n                    log(\"122\",\"smoothWheel\",\"remove\", \"\");\n                    running=false;\n                    container.unbind(\"mousewheel\", onWheel);\n                    container.unbind(\"DOMMouseScroll\", onWheel);\n                }else if(!running){\n                    running=true;\n                    animateLoop();\n                }\n\n            }\n        });\n    };\n\n\n})(jQuery);"],"file":"jquery.smoothwheel.js"}